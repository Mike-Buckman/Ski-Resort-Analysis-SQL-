--STATEMENT TO BRING TOGETHER DATA AND PROVIDE CATEGORIZATIONS FOR TABLEAU ANALYSIS
SELECT 
R.Resort
,R.Latitude AS RESORT_LATITUDE
,R.Longitude AS RESORT_LONGITUDE
,R.Country	
,R.Continent
,R.Price	
,R.Season	
,R."Highest point"	
,R."Lowest point"	
,R."Beginner slopes"	
,R."Intermediate slopes"	
,R."Difficult slopes"	
,R."Total slopes"	
,R."Longest run"	
,R."Snow cannons"	
,R."Surface lifts"	
,R."Chair lifts"	
,R."Gondola lifts"	
,R."Total lifts"	
,R."Lift capacity"	
,R."Child friendly"	
,R.Snowparks	
,R.Nightskiing	
,R."Summer skiing"
,S."Month" AS SNOW_MONTH	
,S.Latitude	AS SNOW_LATITUDE
,S.Longitude AS SNOW_LONGITIUDE	
,S.Snow 
--RANK FOR TOP N OF SNOWFALL BY RESORT
,RANK() OVER (PARTITION BY R.Resort, S.Snow ORDER BY S.snow) AS SNOW_RANK_RESORT
--RANK FOR TOP N OF SNOWFAL BY COUNTRY
,RANK() OVER (PARTITION BY R.Country, S.Snow ORDER BY S.snow) AS SNOW_RANK_COUNTRY
--CATEGORIZATION OF BEGINNER FRIENDLY
,CASE 
	WHEN R."Beginner slopes" >=25 AND R."Beginner slopes" <=35 THEN 'AVERAGE'
	WHEN R."Beginner slopes" <=25 THEN 'NOT BEGINNER'
	WHEN R."Beginner slopes"  >35 THEN 'GREAT FOR BEGINNER'
END BEGINNER_RATING
--CATEGORIZATION OF INTERMEDIATE FRIENDLY
,CASE 
	WHEN R."Intermediate slopes"  >=30 AND R."Intermediate slopes"  <=40 THEN 'AVERAGE'
	WHEN R."Intermediate slopes"  <=29 THEN 'NOT INTERMEDIATE'
	WHEN R."Intermediate slopes"   >40 THEN 'GREAT FOR INTERMEDIATE'
END INTERMEDIATE_RATING
--CATEGORIZATION OF ADVANCED FRIENDLY
,CASE 
	WHEN R."Difficult slopes"  >=15 AND R."Difficult slopes"  <=20 THEN 'AVERAGE'
	WHEN R."Difficult slopes"  <=14 THEN 'NOT DIFFICULT'
	WHEN R."Difficult slopes"   >20 THEN 'GREAT FOR ADVANCED'
END DIFFICULT_RATING
FROM resorts R JOIN snow S 
--JOIN ON ROUNDED LOCATION FOR SNOWFALL
ON ROUND(R.Latitude) = ROUND(S.Latitude) 
AND ROUND(R.Longitude) = ROUND(S.Longitude) 
